<!DOCTYPE html><html lang="en"><head><title>Архитектура компьютера и операционные системы</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="../../../common/shower/themes/ribbon/styles/screen-16x10.css"><style type="text/css">.caption {
    color: #FFF;
}</style></head><body class="shower list"><header class="caption"><h1>Архитектура компьютера и операционные системы</h1><p>Семинар 1. Основы работы в Linux</p></header><section id="cover" class="slide"><h2>Семинар 1. Основы работы в Linux</h2><p>Архитектура компьютера и операционные системы @ ВШЭ, 2018-2019</p><img src="./img/cover.jpg" alt="" class="cover"><style type="text/css">#cover h2 {
    margin: 30px 0 0;
    color: #FFF;
    text-align: center;
    font-size: 70px;
    text-shadow: black 1px 1px 0, black -1px -1px 0, 
                 black -1px 1px 0, black 1px -1px 0;
}
#cover p {
    margin: 10px 0 0;
    text-align: center;
    color: #FFF;
    font-style: italic;
    font-size: 20px;
    text-shadow: black 1px 1px 0, black -1px -1px 0, 
                 black -1px 1px 0, black 1px -1px 0;
}
#cover p a {
    color: #FFF;
    text-shadow: black 1px 1px 0, black -1px -1px 0, 
                 black -1px 1px 0, black 1px -1px 0;
}</style></section><section class="slide"><h2>О чем этот курс</h2><ul><li>Работа в UNIX-подобных системах</li><li>Низкоуровневое программирование на C</li><li>Принципы работы программ и ассемблер x86</li><li>Взаимодействие с OS Linux, системные вызовы</li></ul></section><section class="slide"><h2>Организационные вопросы</h2><ul><li>Продолжительность курса - три модуля</li><li>После каждого семинара - домашнее задание на две недели (после - сдача со штрафом)</li><li>Раз в две недели - контрольная на одну пару</li><li>Вопросы и обсуждения в <a href="https://t-do.ru/joinchat/A1QZuRKSU4kST25wU-pwCA">Telegram</a></li></ul></section><section class="slide"><h2>Семейство UNIX</h2><ul><li>Согласно <a href="https://w3techs.com/technologies/overview/operating_system/all">W3Techs</a>,
UNIX используется на 68.4% сайтов, Windows - на 31.6%</li><li>Из UNIX в 54.4% используется Linux, 0.9% - BSD, меньше 0.1% - Darwin, HP-UX, Solaris, Minix,
44.7% - Unknown</li></ul></section><section class="slide"><h2>Семейство UNIX</h2><a href="https://en.wikipedia.org/wiki/Unix" style="color: rgba(0,0,0,0);"><img src="./img/unix.svg" style="width: 100%; height: calc(100% - 100px); object-fit: contain;"></a></section><section class="slide"><h2>Установка Linux</h2><ul><li>Поставить основной/дополнительной системой</li><li>Установить на виртуальной машине <a href="https://www.virtualbox.org/">VirtualBox</a>
<a href="https://goo.gl/G10hmh">подготовленный образ</a> с Debian LINUX</li></ul></section><section class="slide"><h2>Терминология</h2><ul><li>Файловая система - иерархию файлов и каталогов.
Не нужно называть каталоги "папками"</li><li>Все файлы равнозначны, понятия "расширение файла" не существует
(только добавляют суффикс для удобства)</li><li>В системе выполняется огромное количество процессов, они
могут быть запущены как непосредственно пользователем, так и одним из демонов,
которые запускаются при загрузке системы, и сами по себе являются процессами</li></ul></section><section class="slide"><h2>Обозначения клавиатурных сочетаний</h2><ul><li><code>C-Буква</code> - одновременное нажатие Ctrl и буквенной клавиши</li><li><code>M-Буква</code> - одноваременное нажатие Alt и буквенной клавиши</li><li><code>C-Буква1 Буква2</code> - сначала одновременное нажатие Ctrl и Буква1, затем отпустить клавишу Ctrl и нажать Буква2. Аналогично для клавиши Alt</li></ul></section><section class="slide"><h2>Обозначения клавиатурных сочетаний</h2><ul><li><code>C-Буква1 C-Буква2</code> - нажать Ctrl, затем нажать и отпустить Буква1, нажать и отпустить Буква2</li><li><code>Клавиши F13...F15</code> - на PC-клавиатуре их нет. Их нажатие обеспечивается клавишей Shift и одной функциональных клавиш с номером F... меньше, в зависимости от терминала, на 10 или на 12</li></ul></section><section class="slide"><h2>Удаленный вход по SSH</h2><ul><li>Для подключения по SSH необходимо использовать команду (для Linux/Mac) <code>ssh ИМЯ_ПОЛЬЗОВАТЕЛЯ@ИМЯ_ХОСТА</code></li><li>Если имя пользователя совпадает с именем текущего пользователя, можно его опустить</li><li>Для Windows существуют специальные программы, например <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">PuTTY</a></li><li>После подключения необходимо ввести пароль</li><li>Указание порта для входа <code>ssh -p PORT ИМЯ_ПОЛЬЗОВАТЕЛЯ@ИМЯ_ХОСТА</code> (по умолчанию 22)</li></ul></section><section class="slide"><h2>Использование нескольких экземпляров командной строки</h2><ul><li>При использовании текстового терминала, можно использовать сочетания клавиш от Alt+F1 до Alt+F6 для переключения между различными консолями</li><li>Использовать <code>tmux</code></li></ul></section><section class="slide"><h2>Самая полезная команда</h2><b><code>man РАЗДЕЛ ИМЯКОМАНДЫ</code></b><p>Например, <code>man ls</code> позволяет получить полную справку по программе <code>ls</code></p><ul><li>1 - команды оболочки</li><li>1p - команды оболочки; выводится документация только на ту функциональность, которая соответствует стандарту POSIX</li><li>2 - системные вызовы ядра операционной системы</li><li>3 - функции стандартной библиотеки Си</li></ul></section><section class="slide"><h2>Самая полезная команда</h2><ul><li>3p - Си-функции POSIX API</li><li>4 - описания модулей ядра и системных устройств</li><li>5 - описания форматов конфигурационных файлов</li><li>6 - описания программ для X11</li><li>7 - различные руководства, не попадающие под какую-либо классификацию</li><li>8 - руководства по администрированию</li><li>n - руководства Tcl.</li></ul></section><section class="slide"><h2>Работа с командной строкой</h2><ul><li>Промт (приветственная строка) - <code>ИМЯ_ПОЛЬЗОВАТЕЛЯ@ИМЯ_ХОСТА:ТЕКУЩИЙ_КАТАЛОГ></code></li><li><code>/</code> - корневой каталог, <code>~</code> - домашний каталог</li><li>. - текущий католог, .. - католог на уровень выше</li><li><code>cd</code> - перейти в домашний каталог,
<code>cd PATH</code> - перейти по пути PATH (абсолютному или относительному),
<code>cd -</code> - перейти в предыдущий каталог</li><li><code>TAB</code> - автодополнение имени</li></ul></section><section class="slide"><h2>Иерархия файловой системы</h2><ul><li><code>/bin</code> - выполняемые программы, предоставляющие минимально необходимый набор команд</li><li><code>/boot</code> - файлы, необходимые для загрузки операционной системы</li><li><code>/dev</code> - псевдо-файлы устройств</li><li><code>/etc</code> - текстовые файлы конфигов</li><li><code>/home</code> - домашние каталоги пользователей</li><li><code>/lib</code>, <code>/lib64</code> - минимально необходимый для работоспособности системы набор разделяемых библиотек</li></ul></section><section class="slide"><h2>Иерархия файловой системы</h2><ul><li><code>/lost+found</code> - файлы, которые по каким-либо причинам (например, неправильное выключение компьютера, или сбой диска) оказались вне какого-либо каталога, но их содержимое доступно</li><li><code>/media</code> - каталог для монтирования сменных носителей</li><li><code>/mnt</code> - каталог для монтирования общедоступных сетевых файловых систем или инородных разделов</li><li><code>/opt</code> - каталог для установки сторонних приложений не из репозитория дистрибутива</li></ul></section><section class="slide"><h2>Иерархия файловой системы</h2><ul><li><code>/proc</code> - виртуальная файловая система с информацией о запущенных в системе процессах</li><li><code>/root</code> - домашний каталог пользователя root</li><li><code>/run</code> - содержит именованные сокеты и текстовые файлы с индентификаторами процесса для запущенных демонов</li><li><code>/sbin</code> - выполняемые файлы для запуска пользователем root; у других пользователей этот каталог не включен в переменную окружения PATH</li></ul></section><section class="slide"><h2>Иерархия файловой системы</h2><ul><li><code>/srv</code> - файлы для хранения данных сетевыми службами</li><li><code>/sys</code> - виртуальная файловая система для просмотра и изменения параметров ядра</li><li><code>/tmp</code> - каталог для временных файлов</li><li><code>/usr</code> - файлы большинства программ, которые устанавливаются из репозиториев дистрибутива</li></ul></section><section class="slide"><h2>Иерархия файловой системы</h2><ul><li><code>/usr/local</code> - аналогично /usr, но предназначен для установки программ самостоятельно из исходных текстов</li><li><code>/var</code> - содержит данные различных демонов, например базы данных</li></ul></section><section class="slide"><h2>Стандартные программы для управления файлами</h2><ul><li><code>cp</code> - копирование файла или каталога (с опцией -R)</li><li><code>mv</code> - переименование (перемещение) файла или каталога</li><li><code>rm</code> - удаление файла или каталога (с опцией -r)</li><li><code>ls</code> - вывод содержимого текущего каталога</li><li><code>mkdir</code> - создание католока (-p - с промежуточными)</li><li><code>touch</code> - создание файла</li></ul></section><section class="slide"><h2>Стандартные программы для управления файлами</h2><ul><li><code>cat</code> - вывести содержимое файла</li><li><code>less</code> - постраничный вывод содержимого файла, с возможностью пролистывания в обе стороны</li><li><code>head</code> - вывести первые строки файла</li><li><code>tail</code> - вывести последние строки файла</li><li><code>scp</code> - копирование файла по SSH</li></ul></section><section class="slide"><h2>Установка программ из репозитория</h2><ul><li><code>apt-get update</code> - обновить список доступных пакетов</li><li><code>apt-cache search ИМЯ</code> - поиск пакета по имени</li><li><code>apt-get install ИМЯ</code> - установка пакета</li></ul></section><section class="slide"><h2>Работа с файлами</h2><ul><li><code>mc</code> - Midnight Commander, <a href="http://mydebianblog.blogspot.com/2011/01/midnight-commander.html">команды и горячие клавиши</a></li><li><code>vim</code> - <a href="http://mydebianblog.blogspot.com/2012/03/vim.html">основы работы</a> или команда <code>vimtutor</code></li><li><code>nano</code> - <a href="https://help.ubuntu.ru/wiki/nano">основы работы</a></li><li>Файловая система ВМ доступна по FTP: <code>"ftp://student@192.168.56.105/"</code></li></ul></section><section class="slide"><h2>Права доступа</h2><ul><li><code>ls -li</code> - просмотр подробной информации о файлах</li><li>Три типа полномочий - чтения (r от read), записи (w от write) и выполнения (x от execution)</li><li>Исполняемый файл или нет определяется полномочиями выполнения</li><li>Три группы - полномочия пользователя, его группы и всех остальных</li><li>9 бит, представляется как три цифры (rwxr-xr-- = 754)</li></ul></section><section class="slide"><h2>Права доступа</h2><ul><li><code>chmod</code> - управление правами доступа</li><li><code>chmod (к_какой_группе_прав)(что_сделать_с_правами)(какие_права) над_каким_объектом</code></li><li><code>chmod (права) над_чем</code></li></ul></section><section class="slide"><h2>Исполняемые файлы</h2><ul><li>Должны быть права на выполнение файла</li><li>Бинарный файл начинается с байт <code>0x7F 0x45 0x4C 0x46</code>. Этот формат называется ELF (Executable and Linkable Format)</li><li>Произвольный файл, в том числе текстовый, который начинается с текстовой строки вида <code>#!ИМЯ_ИНТЕРПРЕТАТОРА\n</code>.
В этом случае, система запускает указанный интерпретатор, и передает ему выполняемый файл в качестве аргумента.</li></ul></section><sections class="slide"><h2>Исполняемые файлы</h2><ul><li>Исполняемый файл можно запустить, указав путь до него (если в текущем каталоге - через ./</li><li>Если каталог находится в переменной окружения <code>PATH</code>, то достаточно указать имя исполняемого файла</li></ul></sections><section class="slide"><h2>Исполняемые файлы</h2><ul><li>В ОС семейства UNIX принято сигнализировать о успешности/неуспешности завершения процесса кодом возврата</li><li><code>0</code> - процесс завершился успешно, иначе - неуспешно (код ошибки может нести в себе дополнительную информацию)</li><li>Узнать код возврата предыдущего процесса можно командой <code>echo $?</code></li></ul></section><section class="slide"><h2>Аргументы командной строки</h2><ul><li>В python аргументы командной строки получаются через список <code>sys.argv</code></li><li>В C/C++ аргументы командной строки получаются через аргументы функции main</li><li>Первый элемент массива - сама команда</li></ul></section><section class="slide"><h2>Перенаправление вывода команд в файл</h2><ul><li>Команда echo выводит текст на <i>стандартный поток</i> вывода (stdout)</li><li>Вывод с stdout можно перенаправить в файл: <code>echo Hello > hello.txt</code></li><li>Часто применяется при написании скриптов для создания простых текстовых файлов</li><li>Оператор <code>></code> перезапишет содержимое файла, оператор <code>>></code> допишет в конец файла</li></ul></section><section class="slide"><h2>Поток вывода и поток ошибок</h2><ul><li>Еще один стандартный поток вывода - поток ошибок (stderr)</li><li>Оператор <code>></code> по умолчанию пишет только из потока вывода</li><li>Можно указать файловый дескриптор <code>1>out.txt 2>err.txt</code></li><li>Перенаправлять потоки можно не только в физически существующие файлы, но и в другие потоки
<code>>combined_out.txt 2>&1</code> - выведет оба потока в файл</li></ul></section><section class="slide"><h2>Поток ввода</h2><ul><li>В поток ввода (stdin) поступает ввод с клавиатуры</li><li>Можно указать произвольный файл в качестве потока ввода: <code>&lt;input.txt</code></li><li>Оператор <code>|</code> между командами соединяет стандартный поток вывода первой команды со стандартным потоком ввода второй команды, образуя канал передачи данных</li></ul></section><section class="slide"><h2>Комбинации клавиш Ctrl+D и Ctrl+C</h2><ul><li>Если чтение происходит с клавиатуры, то принудительно закрыть входной поток можно с помощью комбинации клавиш <code>Ctrl+D</code></li><li>Многие программы, работающие в режиме интерпретатора команд, заканчивают свою работу после закрытия потока</li><li>Для принудидельного завершения работы программы до того, как она выполнила свою работу, используется сочетание клавиш <code>Ctrl+C</code>
Программы могут перехватывать этот сигнал</li></ul></section><section class="slide"><h2>grep</h2><ul><li>Выполняет фильрацию строк входного потока по регулярному выражению или входжению некоторого текста и выводит результат в поток вывода</li><li><code>-F</code> - выполнять поиск простого текста, а не регулярного выражения</li><li><code>-v</code> - инвертировать условие поиска на противоположное</li><li><code>-q</code> - ничего не выводить на экран (если требуется только код возврата)</li><li>Код возврата: 0 - найдено, 1 -иначе, другие - ошибка</li></ul></section><section class="slide"><h2>Подстановка вывода команд</h2><ul><li>Команда с необходимыми аргументами заключается в обратные одинарные кавычки (этот символ находится на PC-клавиатуре на одной клавише с буквой Ё)</li><li>Пример: <code>mkdir temp-`date +%Y%m%d-%H%M`</code></li></ul></section><section class="slide"><h2>BASH-скрипты</h2><ul><li>Фактически, набор команд для исполнения интерпретатором командной строки</li><li>Доступны все установленные CLI-программы (Command Line Interface)</li><li>Почти все, что можно сделать в командной строке, можно сделать в bash-скрипте</li></ul></section><section class="slide"><h2>BASH-скрипты</h2><ul><li>Обычно, имеют расширение <code>.sh</code> или никакого</li><li>Есть много интерпретаторов, и много форматов скриптов (кроме bash, например, есть zsh и др.)</li><li>В начале скрипта можно добавить <code>#!/bin/sh</code> (в этом случае будет вызван дефолтный интерпретатор) или <code>#!/bin/bash</code></li></ul></section><section class="slide"><h2>Операторы</h2><ul><li><code>;</code> (точка с запятой) -- является разделителем между последовательно выполняемыми командами. Эквивалентен переносу строки</li><li><code>&amp;</code> (амперсанд, Shift+7) -- ставится после команды (и ее аргументов). Команда будет выполнена в фоновом режиме, а интерпретатор продолжает свою работу</li><li><code>&amp;&amp;</code> и <code>||</code> -- аналогичны операторам в языке Си. Код завершения 0 - "истина"; все остальные - "ложь"</li></ul></section><section class="slide"><h2>Операторы</h2><ul><li><code>&gt;</code>, <code>&gt;&gt;</code>, <code>&lt;</code> и <code>|</code>  - операторы перенаправления потоков</li></ul></section><section class="slide"><h2>Переменные</h2><ul><li>Объявления переменных <code>ИМЯ=ЗНАЧЕНИЕ</code> <b>без пробелов</b> (фактически, переменные окружения)</li><li>Переменные окружения часто используются для конфигурирования различных программ и скриптов</li><li>Доступ к переменным - <code>$ИМЯ</code> или <code>${ИМЯ_С_ПОДЧЕРКИВАНИЕМ}</code> (если есть символ подчеркивания)</li><li>Сделать переменную доступной дочерним процессам <code>export ИМЯ=ЗНАЧЕНИЕ</code> или <code>export ИМЯ</code></li></ul></section><section class="slide"><h2>Специальные имена переменных</h2><ul><li><code>$0</code> - имя команды текущего процесса</li><li><code>$1</code> <code>$2</code>, <code>$3</code> и т. д. - значения аргументов, переданных shell-скрипту</li><li><code>$*</code> - список, состоящий из всех аргументов, передеанных shell-скрипту</li><li><code>$#</code> - количество аргументов</li><li><code>$?</code> - код возврата предыдущей выполненной команды</li></ul></section><section class="slide"><h2>Ключевые слова и конструкции</h2><ul><li><code>#</code> - комментарий</li><li><code>`КОМАНДА`</code> (обратные одинарные кавычки) - вывод команды как текст</li></ul></section><section class="slide"><h2>Проверка условия</h2><pre style="white-space:pre;">if ВЫРАЖЕНИЕ 1
then
    НАБОР КОМАНД 1
elif ВЫРАЖЕНИЕ 2
    НАБОР КОМАНД 2
else
    НАБОР КОМАНД 3
fi</pre></section><section class="slide"><h2>Выбор вырианта</h2><pre style="white-space:pre; font-size:14pt;"> case ПЕРЕМЕННАЯ in
    ВАРИАНТ1|ВАРИАНТ2|ВАРИАНТ3)
    НАБОР КОММАНД 1
    ;;
    ВАРИАНТ4)
    НАБОР КОММАНД 2
    ;;
    *)
    НАБОР КОММАНД 3
    ;;
esac</pre></section><section class="slide"><h2>Цикл while</h2><pre style="white-space:pre;">while УСЛОВИЕ
do
   НАБОР КОММАНД
done</pre></section><section class="slide"><h2>Цикл for</h2><pre style="white-space:pre;">for ИМЯ in СПИСОК
do
    НАБОР КОММАНД
done</pre></section><section class="slide"><h2>Команда <code>&#91;</code></h2><ul><li>Предназначена для формирования логических выражений вида <code>&#91; ВЫРАЖЕНИЕ &#93;</code></li><li>Команды <b>должны отделяться пробелом</b></li><li><code>-n СТРОКА</code> - истина, если длина строки ненулевая</li><li><code>-z СТРОКА</code> - истина, если строка пустая</li><li><code>СТРОКА1 = СТРОКА2</code> - истина, если строки равны</li><li><code>СТРОКА1 != СТРОКА2</code> - истина, если строки различные</li></ul></section><section class="slide"><h2>Команда <code>&#91;</code></h2><ul><li><code>ЧИСЛО1 -eq ЧИСЛО2</code> - числовое равенство</li><li><code>ЧИСЛО1 -ne ЧИСЛО2</code> - числовое равенство</li><li><code>ЧИСЛО1 -gt ЧИСЛО2</code> - ЧИСЛО1 &gt; ЧИСЛО2</li><li><code>ЧИСЛО1 -ge ЧИСЛО2</code> - ЧИСЛО1 &gt;= ЧИСЛО2</li><li><code>ЧИСЛО1 -lt ЧИСЛО2</code> - ЧИСЛО1 &lt; ЧИСЛО2</li><li><code>ЧИСЛО1 -le ЧИСЛО2</code> - ЧИСЛО1 &lt;= ЧИСЛО2</li></ul></section><section class="slide"><h2>Команда <code>&#91;</code></h2><ul><li><code>-e ИМЯФАЙЛА</code> - указанный путь существует</li><li><code>-d ИМЯФАЙЛА</code> - указанный путь существует и является каталогом</li><li><code>-f ИМЯФАЙЛА</code> - указанный путь существует и является обычным файлом</li></ul></section><section class="slide"><h2>Команды <code>read</code> и <code>printf</code></h2><ul><li>Команда read читает одну строку (до символа \n) из потока ввода, и сохраняет ее значение в указанной переменной</li><li><code>read SOME_VAR</code></li><li>Если поток данных завершился до ввода строки, то возвращается не нулевой код возврата</li><li><code>printf</code> - форматированный вывод</li></ul></section><div class="progress"></div><script src="../../../common/shower/shower.min.js"></script></body></html>